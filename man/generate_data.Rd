% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_data.R
\name{generate_data}
\alias{generate_data}
\title{generate_data}
\usage{
generate_data(
  J = 100,
  njrange = c(50, 100),
  Mfamily = "binomial",
  Yfamily = "binomial",
  if.null = FALSE,
  seed = 123456,
  num_x = 3,
  a_on_x = sqrt(0.05625/3),
  a_on_z = sqrt(0.15/1),
  x_z = 0,
  m_on_a = 0.2,
  m_on_az = 0.2,
  m_on_anj = 0.2,
  m_on_x = sqrt(0.15/num_x),
  m_on_z = sqrt(0.4),
  yintercept = 1,
  y_on_a = 0.5,
  y_on_m = 1,
  y_on_am = 0,
  y_on_az = 0.2,
  y_on_mz = 0.2,
  y_on_anj = 0.2,
  y_on_x = sqrt(0.15/num_x),
  y_on_z = sqrt(0.4),
  quadratic.A = FALSE,
  quadratic.M = FALSE,
  quadratic.Y = FALSE,
  iccx = 0.2,
  icca = 0.2,
  iccm = 0.2,
  iccy = 0.2,
  include_truevals = TRUE,
  include_overlapMsg = TRUE,
  plot_PSdiagnostics = FALSE,
  randomize = FALSE,
  ensure_cluster_positivity = TRUE
)
}
\arguments{
\item{J}{Integer. Number of clusters (default: 100).}

\item{njrange}{Integer vector of length 2. Range (min, max) for cluster sizes (default: \code{c(50, 100)}).}

\item{Mfamily}{Character. Family for the mediator (\code{"gaussian"} or \code{"binomial"}). Defaults to \code{"binomial"}.}

\item{Yfamily}{Character. Family for the outcome (\code{"gaussian"} or \code{"binomial"}). Defaults to \code{"binomial"}.}

\item{if.null}{Logical. If \code{TRUE}, generate data under the null hypothesis (i.e., no effects). Defaults to \code{FALSE}.}

\item{seed}{Integer. Random seed for reproducibility (default: 123456).}

\item{num_x}{Integer. Number of individual-level covariates (\code{X}). Defaults to 3.}

\item{a_on_x}{description.......}

\item{a_on_z}{description.......}

\item{x_z}{Numeric. Correlation between \code{X} and the cluster-level variable \code{Z} (default: 0).}

\item{m_on_a}{Numeric. Main effect of treatment \code{A} on mediator \code{M} (default: 0.2).}

\item{m_on_az}{Numeric. Interaction effect of \code{A} and \code{Z} on \code{M} (default: 0.2).}

\item{m_on_anj}{Numeric. Interaction effect of \code{A} and cluster size (\code{nj}) on \code{M} (default: 0.2).}

\item{m_on_x}{Numeric. Effect of each individual-level covariate \code{X} on \code{M}.
Defaults to \code{sqrt(0.15 / num_x)}.}

\item{m_on_z}{Numeric. Effect of cluster-level variable \code{Z} on \code{M}. Defaults to \code{sqrt(0.4)}.}

\item{yintercept}{Numeric. Intercept in the outcome \code{Y} model (default: 1).}

\item{y_on_a}{Numeric. Main effect of \code{A} on \code{Y} (default: 0.5).}

\item{y_on_m}{Numeric. Main effect of \code{M} on \code{Y} (default: 1).}

\item{y_on_am}{Numeric. Interaction effect of \code{A} and \code{M} on \code{Y} (default: 0).}

\item{y_on_az}{Numeric. Interaction effect of \code{A} and \code{Z} on \code{Y} (default: 0.2).}

\item{y_on_mz}{Numeric. Interaction effect of \code{M} and \code{Z} on \code{Y} (default: 0.2).}

\item{y_on_anj}{Numeric. Interaction effect of \code{A} and cluster size (\code{nj}) on \code{Y} (default: 0.2).}

\item{y_on_x}{Numeric. Effect of each individual-level covariate \code{X} on \code{Y}.
Defaults to \code{sqrt(0.15 / num_x)}.}

\item{y_on_z}{Numeric. Effect of \code{Z} on \code{Y}. Defaults to \code{sqrt(0.4)}.}

\item{quadratic.A}{Logical. If \code{TRUE}, include quadratic term for \code{A} in the mediator/outcome models (default: FALSE).}

\item{quadratic.M}{Logical. If \code{TRUE}, include quadratic term for \code{M} in the outcome model (default: FALSE).}

\item{quadratic.Y}{Logical. If \code{TRUE}, include quadratic term for \code{Y} itself (used in some advanced simulations) (default: FALSE).}

\item{iccx}{Numeric. Intra-class correlation for the \code{X} variables (default: 0.2).}

\item{icca}{Numeric. Intra-class correlation for treatment \code{A} (default: 0.2).}

\item{iccm}{Numeric. Intra-class correlation for mediator \code{M} (default: 0.2).}

\item{iccy}{Numeric. Intra-class correlation for outcome \code{Y} (default: 0.2).}

\item{include_truevals}{Logical. If \code{TRUE}, call \code{trueVals2.0d()} to compute the true potential outcomes and
mediation effects (default: TRUE).}

\item{include_overlapMsg}{Logical. If \code{TRUE}, ...  (default: TRUE).}

\item{plot_PSdiagnostics}{Logical. If \code{TRUE}, ... (default: FALSE).}

\item{randomize}{Logical. If \code{TRUE}, randomizes treatment \code{A} (default: FALSE).}

\item{ensure_cluster_positivity}{Logical. If \code{TRUE}, will only generate data that meets the positivity assumption (default: TRUE).}
}
\value{
A list containing:
\describe{
\item{\code{data}}{A data frame containing the simulated data:
\code{A} (treatment), \code{M} (mediator), \code{Y} (outcome),
\code{Z} (cluster-level var), \code{X} (individual-level covariates),
\code{school} (cluster ID), etc.}
\item{\code{truevals}}{(Optional) A list of the true potential outcomes under different
\code{(A, M)} interventions if \code{include_truevals = TRUE}.}
\item{\code{effects}}{A list of mediation effects (PNDE, PNIE, TNDE, TNIE) at both individual and cluster levels,
if \code{include_truevals = TRUE}. Otherwise, this may be \code{NULL}.}
\item{\code{overlap}}{A list containing diagnostic plots and summary for propensity scores (\code{ps_true})
and stabilized IPTW (\code{iptw_true}). Useful for checking overlap/outliers.}
\item{\code{parameters}}{A list of the input parameters and additional generated values (like \code{nj_sizes})
for documentation and reproducibility.}
}
}
\description{
Generates a clustered dataset with an individual-level treatment (\code{A}), a mediator (\code{M}),
an outcome (\code{Y}), individual-level covariates (\code{X}), and a cluster-level variable (\code{Z}).
Supports both binary and continuous mediators/outcomes, incorporates optional quadratic terms for
treatment/mediator/outcome, and calculates true potential outcome values and mediation effects (if requested).

The function proceeds by:
\enumerate{
\item Generating clusters with a specified size range.
\item Creating individual- and cluster-level covariates, including correlated \code{X} and \code{Z} if desired.
\item Simulating a treatment variable \code{A} with optional intraclass correlation.
\item Simulating the mediator \code{M} given \code{A}, \code{Z}, cluster size, and user-specified interactions.
\item Simulating the outcome \code{Y} given \code{A}, \code{M}, \code{Z}, cluster size, user-specified interactions, etc.
\item (Optionally) Computing the true potential outcomes and mediation effects by calling \code{trueVals2.0d()}.
}
}
\details{
This function is a wrapper that calls several helper functions:
\itemize{
\item \code{generate_clusters()}: Builds the cluster IDs and sets cluster sizes in \code{njrange}.
\item \code{generate_confounders()}: Creates individual-level confounders \code{X} (optionally correlated with \code{Z}).
\item \code{generate_treatment()}: Simulates the binary (or continuous) treatment \code{A} with optional ICC.
\item \code{generate_mediator()}: Simulates \code{M} given \code{A}, \code{Z}, cluster size, etc.,
using the family (\code{binomial} or \code{gaussian}).
\item \code{generate_outcome()}: Constructs outcome \code{Y} based on \code{A}, \code{M}, \code{Z},
interactions, ICC, etc., again depending on the family chosen.
\item \code{trueVals2.0d()}: (Optional) Computes the true potential outcomes for \code{Y(a0, gm(a1))},
cluster-level means, and resulting mediation effects.
}

Propensity score (\code{ps_true}) and IPTW weights (\code{iptw_true}) are also computed for
reference and diagnostic plotting.
}
\examples{
# Generate data with smaller clusters and continuous M, continuous Y:
result <- generate_data(
  J = 50,
  njrange = c(10, 20),
  Mfamily = "gaussian",
  Yfamily = "gaussian"
)
str(result$data)  # Inspect the generated data

}
